---
layout: Post
title: React ä½¿ç”¨ SVG çš„å§¿åŠ¿ # åšå®¢æ ‡é¢˜ï¼ˆå¿…é¡»ï¼‰
date: 2022-04-07 # åšå®¢æ—¥æœŸï¼Œä¼šæ˜¾ç¤ºåœ¨æ–‡ç« å¤´éƒ¨ï¼ˆå¯é€‰ï¼‰
author: Lucas
author_title: ä¸€æšå°å‰ç«¯
author_url: https://github.com/ihoneys
author_image_url: img/ihoneys.png
catalog: true # æ˜¯å¦å¯ç”¨å³ä¾§ç›®å½•ï¼šfalse / trueï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º falseï¼‰
tags: [React, SVG]
---

åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œè·Ÿ svg æ‰“äº¤é“å¯ä»¥è¯´å¿…ä¸å¯å°‘ï¼Œæƒ³å¯¹æ¯” pngï¼Œsvg æ›´å¯æ§ï¼Œè¿˜èƒ½æ”¹å˜ svg çš„æ ·å¼ï¼Œä½“ç§¯ä¹Ÿä¼šå°å¾ˆå¤šï¼Œä¹Ÿç›¸å½“äºä¸€ç§æ€§èƒ½ä¼˜åŒ–ã€‚ä¸‹é¢çœ‹çœ‹ React ä¸­ä½¿ç”¨ svg çš„å§¿åŠ¿ã€‚

<!--truncate-->

## å‰è¨€

svg å®ƒæ˜¯ä¸€ç§å‘é‡å›¾çš„å›¾ç‰‡æ ¼å¼ï¼Œå³å¯ä¼¸ç¼©å‘é‡å›¾ï¼ˆScalable Vetor Graphicsï¼‰ã€‚åœ¨æ„å»ºå‰ç«¯åº”ç”¨æ—¶ç»å¸¸ä½¿ç”¨ä¸€äº›å›¾æ ‡ï¼Œç›¸å¯¹åº”æˆ‘ä»¬ä¼šæ¯”è¾ƒåå‘äºä½¿ç”¨ svgï¼Œé‚£ä¹ˆ svg æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Œæ¥ä¸‹æ¥ä¼šè¯´åˆ°ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦å›´ç»•åœ¨ React ä¸­å¦‚ä½•é€šè¿‡ç»„ä»¶çš„æ–¹å¼ä½¿ç”¨ svgã€‚

é¦–å…ˆçœ‹çœ‹åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ svg æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ

- å‹ç¼©åçš„æ–‡ä»¶ä½“ç§¯å°
- å¯ä»¥æ— æŸä¼¸ç¼©åˆ°ä»»æ„å°ºå¯¸ï¼ˆç‰¹åˆ«å°çš„å°ºå¯¸ï¼Œéœ€è¦ä¸€äº› css ç‰¹æ€§æ¥è§£å†³ï¼‰ï¼Œæ”¾å¤§ä¸ä¼šå¤±çœŸ
- è®¾è®¡å¯æ§ï¼Œæ¯”å¦‚äº¤äº’å’Œæ»¤é•œ

é‚£ä¹ˆä¸‹é¢ä¼šè¯´è¯´ React å¼€å‘ä¸­ï¼Œå¦‚ä½•ç»„ä»¶åŒ–ä½¿ç”¨ SVG çš„ï¼Œä¼šè®²çš„å®ç°æ–¹å¼æœ‰ä¸¤ç§ ï¼š

- é€šè¿‡æ’ä»¶ `webpack-iconfont-plugin-nodejs` + å°è£… Icon ç»„ä»¶å®ç°ï¼›
- Vite æ„å»ºä¸‹ä½¿ç”¨ `vite-plugin-svgr` æ’ä»¶ ç›´æ¥å¯¼å…¥å®ç°ï¼›

## å®ç°æ–¹å¼

### **å°è£… Icon ç»„ä»¶å®ç°ä½¿ç”¨**

è¿™ç§æ–¹å¼ç”Ÿæˆå­—ä½“æ–‡ä»¶ï¼Œç„¶åå†ä½¿ç”¨å¯¹åº”çš„ç±»å‹æ¥æ˜¾ç¤ºçš„ã€‚

é¦–å…ˆéœ€è¦å®‰è£…ä¾èµ– `webpack-iconfont-plugin-nodejs`

```bash
yarn add webpack-iconfont-plugin-nodejs

# or

npm install webpack-iconfont-plugin-nodejs
```

å†é¡¹ç›®æ›´ç›®å½•åˆ›å»º svg2font.js æ–‡ä»¶

```bash
const WebpackIconfontPluginNodejs = require('webpack-iconfont-plugin-nodejs')
const path = require('path')

const dir = 'src'

const options = {
  fontName: 'xxx-icons', // ç”Ÿæˆæ–‡ä»¶åç§°
  cssPrefix: 'b-font', // className ä½¿ç”¨çš„ svg çš„å‰ç¼€åç§°
  svgs: path.join(dir, 'svg/*.svg'), // è·å– svg çš„æ–‡ä»¶å¤¹ä½ç½®ã€‚
  fontsOutput: path.join(dir, 'fonts/'), // åˆ›å»º fonts æ–‡ä»¶å¤¹å­˜æ”¾ä¸‹é¢è¾“å‡ºçš„æ–‡ä»¶ğŸ‘‡
  cssOutput: path.join(dir, 'fonts/font.css'),
  htmlOutput: path.join(dir, 'fonts/_font-preview.html'),
  jsOutput: path.join(dir, 'fonts/fonts.js'),
}

new WebpackIconfontPluginNodejs(options).build() // æ‰§è¡Œå¹¶æ„å»ºç”Ÿæˆ
```

è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€åªå‘½ä»¤å‘½ä»¤æ‰§è¡Œ svg2font.js æ¥ç”Ÿæˆå¯¹åº”çš„ fonts æ–‡ä»¶ã€‚

åœ¨ package.json ä¸­æ·»åŠ å‘½ä»¤

```json
"scripts": {
  "svg": "rm -rf fonts; node svg2font.js;"
},
```

å°†è®¾è®¡ç»™çš„ svg å›¾æ ‡ä¸‹è½½æ·»åŠ åˆ° src/svg æ–‡ä»¶å¤¹ ğŸ“ ä¸‹ï¼Œæ‰§è¡Œ `yarn svg` ï¼Œç”Ÿæˆå­—ä½“æ–‡ä»¶ã€‚

æœ‰äº†å­—ä½“æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç±»åå»ç›´æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚ `<i class=â€œb-font-{svgæ–‡ä»¶åç§°}â€ />`

è¿™æ ·è™½ç„¶å¯ä»¥ä½†æ˜¯ä¸å¤Ÿä¼˜é›…ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…æˆä¸€ä¸ª Icon ç»„ä»¶æ¥ä½¿ç”¨ã€‚

**ç¼–å†™ Icon ç»„ä»¶**

src/components/Icon/icon.tsx

```tsx
import { FC, AnchorHTMLAttributes } from "react";
import classNames from "classnames";

// React.AnchorHTMLAttributes<HTMLElement> ä¿ç•™åŸç”Ÿæ ‡ç­¾å±æ€§
interface IconProps extends React.AnchorHTMLAttributes<HTMLElement> {
  icon: string; // å­˜æ”¾ svg æ–‡ä»¶ä¸‹çš„ svg åç§°
  size?: string | number; // å›¾æ ‡å¤§å°
}

const Icon: FC<IconProps> = ({ icon, size, className, ...restProps }) => {
  return (
    <i
      style={{ fontSize: `${size}px` }}
      className={classNames(`b-font-${icon}`, className)}
      {...restProps}
    />
  );
};

export default Icon;
```

ä½¿ç”¨

```tsx
<Icon icon="wx" size={66} />
```

æ•ˆæœå›¾

![Untitled](./img/react-use-svg.png)

---

### **Vite æ„å»ºä¸‹ä½¿ç”¨æ’ä»¶ç›´æ¥å¯¼å…¥æ–¹å¼**

å®‰è£… `vite-plugin-svgr` æ’ä»¶ä¾èµ–

```bash
yarn add vite-plugin-svgr

# or

npm install vite-plugin-svgr
```

åœ¨ vite.config.ts è¿›è¡Œé…ç½®

```tsx
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import svgr from "vite-plugin-svgr";

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react(), svgr()],
});
```

é‡å¯ `run dev` ï¼Œä½¿ç”¨çš„åœ°æ–¹å¼•ç”¨å¯¼å…¥ï¼š

```tsx
import { ReactComponent as ReactIcon } from "./svg/react.svg";

function App() {
  const [count, setCount] = useState(0);
  // console.log(SvgIcon);
  return (
      <div
        style={{
          background: "#F1F1FF",
        }}
      >
        <ReactIcon />
      </div>
    </div>
  );
}

export default App;
```

åœ¨ ts ç¯å¢ƒé‡Œï¼Œä¼šæç¤º **æ¨¡å— ""\*.svg"" æ²¡æœ‰å¯¼å‡ºçš„æˆå‘˜ "ReactComponentâ€** ,è§£å†³åŠæ³•å°±æ˜¯åœ¨**vite-env.d.ts** æ–‡ä»¶é‡Œé¢æ·»åŠ  ğŸ‘‡ï¼š

```tsx
/// <reference types="vite-plugin-svgr/client" />
```

è¿™æ ·æç¤º ts æ£€æŸ¥ç±»å‹çš„é”™è¯¯å°±ä¼šæ¶ˆå¤±ã€‚

æˆ–è€…åœ¨ ts.config.json é‡Œé¢é…ç½®

```json
{
  "compilerOptions": {
    // çœç•¥å…¶å®ƒé…ç½®
    "types": ["vite-plugin-svgr/client"]
  }
}
```

äºŒè€…å…¶ä¸­ä¸€ä¸ªé…ç½®äº†å³å¯ã€‚

## **æ€»ç»“**

ä¸Šé¢ä»‹ç»äº†ä¸¤ç§æ¨¡å¼ä¸‹ä½¿ç”¨ SVG ï¼Œå¦‚æœæ˜¯åœ¨ webpack æ„å»ºä¸‹ï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼ŒVite æ„å»ºï¼Œç›´æ¥ç”¨ç¬¬äºŒç§æ–¹å¼æ¯”è¾ƒæ–¹ä¾¿ä¾¿æ·ã€‚å¯¹äºä¸Šé¢ä¸¤ç§æ–¹å¼ï¼Œç¤¾åŒºé‡Œé¢è¿˜æœ‰æ›´å¤šæ–¹æ¡ˆï¼Œä»…ä¾›å¤§å®¶å‚è€ƒã€‚
